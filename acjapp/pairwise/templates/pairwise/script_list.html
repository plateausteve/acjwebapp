{% extends 'pairwise/base.html' %}

{% block content %}
    <script src="https://code.highcharts.com/highcharts.src.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.js"   integrity="sha256-Qw82+bXyGq6MydymqBxNPYTaUXXq7c8v3CwiYwLLNXU="   crossorigin="anonymous"></script>
    
    {% load chartit %}
    {{ scriptchart|load_charts:"cht" }}
    <body>
        <h1>Script List with Current Computations:</h1>
        <p>Set {{ set.pk }} correlation estimated to actual: {{ set.cor_est_to_actual }}          Comparisons: {{ listcount }}    Average diff from actual: {{ diffs }}</p>
        <div id='cht'> Chart will be rendered here </div>
        {% if user.is_superuser %}
            {% if jcount > 0 %}
                <form method="POST" class="autocomparisonform">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <input type="hidden" name="scripti" value="{{ scripti }}">
                    <input type="hidden" name="scriptj" value="{{ scriptj }}">
                    <input type="submit" value="Click this button to autocompare Script #{{ scripti.id }} and Script #{{ scriptj.id }}">
                </form>
                {% else %}<h1>Ran out of scripts to pair.</h1>
            {% endif %}
        {% endif %}
        {% if script_table %} 
                <table border="1" style="font-size:x-small">
                    <tr>
                        <th>User</th>
                        <th>Script</th>
                        <th>Comps</th>
                        <th>Wins</th>
                        <th>Prob</th>
                        <th>Same P Count</th>
                        <th>SD</th>
                        <th>low 95% CI</th>
                        <th>LO &phi;</th>
                        <th>high 95% CI</th>
                        <th>MLE &theta;</th>
                        <th>Actual</th>
                        <th>I(&phi;)</th>
                        <th>SE(&phi;)</th>
                        <th>RMSE</th>
                    </tr>
                    {% for script in script_table %}
                    <tr>
                        <td>{{ script.user.pk }}</td>
                        <td>{{ script.pk }}</td>
                        <td>{{ script.comps_in_set }}</td>
                        <td>{{ script.wins_in_set }}</td>
                        <td>{{ script.prob_of_win_in_set }}</td>
                        <td>{{ script.count_same_p }}</td>
                        <td>{{ script.stdev }}</td>
                        <td>{{ script.lo_lo95ci }}</td>
                        <td>{{ script.lo_of_win_in_set }}</td>
                        <td>{{ script.lo_hi95ci }}</td>
                        <td>{{ script.estimated_parameter_in_set }}</td>
                        <td>{{ script.parameter_value }}</td>
                        <td>{{ script.fisher_info }}</td>
                        <td>{{ script.se }}</td>
                        <td>{{ script.rmse_in_set }}</td>
                    </tr>
                    {% endfor %}
                </table>
            <!--</div>-->
        {% else %}
            <p>There are no scripts in the database. Head to the <a href="/admin">admin</a> section to upload a set of them.</p>
        {% endif %}   
        <h3>Debug information:</h3>
        <small>Script J Selection Array: Length: {{ jcount }} Elements: j[id, lodiff, fisher_info, se, rmse] {{ j }}</small>
    </body>
{% endblock %}